<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>許願池</title>
  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
          crossorigin="anonymous"></script>
</head>

<body>

  <header>
    <div class="collapse bg-warning" id="navbarHeader">
      <div class="container">
        <div class="row">
          <div class="col-sm-8 col-md-7 py-4">
            <h4 class="text-black">About</h4>
            <p class="text-muted">
              google表單的串聯練習實作
            </p>
          </div>
          <div class="col-sm-4 offset-md-1 py-4">
            <h4 class="text-black">Contact</h4>
            <ul class="list-unstyled">
              <li><a href="https://forms.gle/T6DV7pRHDtnJZpfRA" class="text-black">聯絡我</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="navbar navbar-light shadow-sm">
      <div class="container">
        <a href="#" class="navbar-brand d-flex align-items-center">
          <strong>許願池</strong>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarHeader"
                aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
    </div>
  </header>

  <main>

    <section class="py-5 text-center container-fluid"
             style="background-image: url('https://images.pexels.com/photos/587741/pexels-photo-587741.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260');">
      <div class="row py-lg-5">
        <div class="col-lg-6 col-md-8 mx-auto">
          <h1 class="fw-light text-white">許願池</h1>
          <p class="lead text-white-50">生活壓力大，今天的下午茶，想點些什麼呢?</p>
          <p>
            <a href="https://forms.gle/BTGUuhz8WQJEGiFv6" class="btn btn-success my-2" target="_blank">我想來點</a>
          </p>
        </div>
      </div>
    </section>

    <div class="album py-5 bg-light">
      <div class="container">

        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3" data-list="block">

          <!-- <div class="col">
            <div class="card shadow-sm">
              <img class="img-fluid" src="https://picsum.photos/id/0/320/150" alt="">
              <div class="card-body">
                <div class="text-muted small">YYYY/MM/DD 下午 HH:MM:SS</div>
                <div class="card-text">您說的願望</div>
                <div class="text-muted small text-end">by你的匿名</div>
              </div>
            </div>
          </div> -->

        </div>
      </div>
    </div>

  </main>

  <footer class="text-muted py-5">
    <div class="container">
      <p class="float-end mb-1">
        <a href="#">Back to top</a>
      </p>
      <p class="mb-1"><a class="text-muted" href="https://www.suhan.tw" target="_blank" rel="noopener noreferrer">by
          suhan.tw</a><br />
        Use Bootstrap5,jQuery ajax ,Lorem Picsum ,Images from <a class="text-muted" target="_blank"
           href="https://unsplash.com">Unsplash</a></p>
    </div>
  </footer>
  <script src="scripts/jquery-3.6.0.min.js"></script>
  <script>
    var ListDom = document.querySelector('[data-list="block"]');
    const spreadsheet_id = '1XmWlOOLEiMiWAdRl2o7pqgAPxs0JImV40xQ8xH-2how';
    const tab_name = 'test2';
    const api_key = 'AIzaSyAMpJ-FWW1qt2uH7auDxkPrXc_hkbg9fKw';
    var dataurl = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheet_id}/values/${tab_name}?key=${api_key}`
    // console.log(dataurl);
    $.ajax({
      url: dataurl,
      type: "GET",
      dataType: "json",
      success: function (Jdata) {
        Jdata.values.shift();//刪除表頭
        // console.log(Jdata.values);
        // console.log("SUCCESS!!!");

        //寫法一
        // let list = "";
        // Jdata.values.forEach(function (k) {
        //   list +=
        //     `<div class="col">
        //       <div class="card shadow-sm">
        //         <img class="img-fluid" src="https://picsum.photos/id/${changeTime(k[0])}/320/150" alt="">
        //         <div class="card-body">
        //           <div class="text-muted small">${k[0]}</div>
        //           <div class="card-text">${k[2]}</div>
        //           <div class="text-muted small text-end">by${k[1]}</div>
        //         </div>
        //       </div>
        //     </div>`;
        // });
        // ListDom.innerHTML = list;

        //寫法二
        // let lis = document.createDocumentFragment();
        // Jdata.values.forEach(function (k) {
        //   let li = document.createElement('div');
        //   let card = document.createElement('div');
        //   let img = document.createElement('img');
        //   let cardBody = document.createElement('div');
        //   let timeinfo = document.createElement('div');
        //   let maininfo = document.createElement('div');
        //   let authorinfo = document.createElement('div');
        //   let  timetxt = document.createTextNode(`${k[0]}`);
        //   let  maintxt = document.createTextNode(`${k[2]}`);
        //   let  authortxt = document.createTextNode(`by${k[1]}`);
        //   li.classList = 'col';
        //   card.classList = 'card shadow-sm';
        //   cardBody.classList = 'card-body';
        //   img.classList = 'img-fluid';
        //   img.setAttribute('alt', '');
        //   img.setAttribute('src', `https://picsum.photos/id/${changeTime(k[0])}/320/150`);
        //   timeinfo.classList = 'text-muted small';          
        //   timeinfo.appendChild(timetxt);   
        //   maininfo.classList = 'card-text';
        //   maininfo.appendChild(maintxt);   
        //   authorinfo.classList = 'text-muted small text-end';
        //   authorinfo.appendChild(authortxt);   
        //   li.appendChild(card);
        //   card.appendChild(img);
        //   card.appendChild(cardBody);
        //   cardBody.appendChild(timeinfo);
        //   cardBody.appendChild(maininfo);
        //   cardBody.appendChild(authorinfo);
        //   lis.appendChild(li);
        // });
        // ListDom.appendChild(lis);

        //寫法三
        let lis = document.createDocumentFragment();
        function setDom(tag, classname) {
          let doms = document.createElement(tag);
          doms.classList = classname;
          return doms;
        }
        Jdata.values.forEach(function (k) {
          let li = setDom('div', 'col');
          let card = setDom('div', 'card shadow-sm');
          let img = setDom('img', 'img-fluid w-100');
          img.setAttribute('width', '320');
          img.setAttribute('height', '150');
          img.setAttribute('alt', '');
          img.setAttribute('src', `https://picsum.photos/id/${changeTime(k[0])}/320/150`);
          let cardBody = setDom('div', 'card-body');
          let timeinfo = setDom('div', 'text-muted small');
          let maininfo = setDom('div', 'card-text');
          let authorinfo = setDom('div', 'text-muted small text-end');
          timeinfo.textContent  = `${k[0]}`;          
          maininfo.textContent  = `${k[2]}`;          
          authorinfo.textContent  = `by${k[1]}`;
          li.appendChild(card);
          card.appendChild(img);
          card.appendChild(cardBody);
          cardBody.appendChild(timeinfo);
          cardBody.appendChild(maininfo);
          cardBody.appendChild(authorinfo);
          lis.appendChild(li);
        });
        ListDom.appendChild(lis);
      },
      error: function () {
        console.log("ERROR!!!");
      }
    });

    function changeTime(option) {
      var currentTime = option;
      var reg = new RegExp("-", "g");
      var a = currentTime.replace(reg, "");
      var regs = new RegExp(" ", "g");
      var b = a.replace(regs, "");
      var regss = new RegExp(":", "g");
      var c = b.replace(regss, "");
      return Number(c.substr(13, 15));
    }
  </script>

</body>

</html>